(window.webpackJsonp=window.webpackJsonp||[]).push([["app"],{0:function(t,e,n){t.exports=n("56d7")},"21af":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e),n("2bf3"),n("0dbc"),n("e612"),n("8cf6"),n("21af"),n("fd41");var o=n("6e6d"),a=(n("1a43"),n("6ac6"),n("39e0")),i=n.n(a),s=n("18b5"),r=n.n(s),l=(n("67c8"),n("6c92")),c=n.n(l),u=(n("cac2"),n("263e"),n("0252")),d=n.n(u);function p(t){var e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}function h(t){if(console.log("option",t),"undefined"!==typeof XMLHttpRequest){var e=new XMLHttpRequest,n=t.action;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});var o=new FormData;t.data&&(console.log("option.data",t.data),c()(t.data).map(function(e){o.append(e,t.data[e])})),o.append(t.filename,t.file),e.onerror=function(e){console.log("xhr error",e),t.onError(e)},e.onload=function(){if(console.log("xhr.status",e,e.status),e.status<200||e.status>=300)return t.onError(function(t,e,n){var o="fail to post ".concat(t," ").concat(n.status,"'"),a=new Error(o);return a.status=n.status,a.method="post",a.url=t,a}(n,0,e),p(e));t.onSuccess(p(e))},e.open("post",n,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);var a=t.headers||{};for(var i in a)a.hasOwnProperty(i)&&null!==a[i]&&e.setRequestHeader(i,a[i]);console.log("formate",o),e.send(o)}}n("e1a2"),n("b7dd"),n("7b62");var f={props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}},paste:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},interceptor:{type:Boolean,default:!1},beforeAjax:{type:Function,default:function(){return{}}}},data:function(){return{fileList:[]}},mounted:function(){},methods:{handleChange:function(t){console.log("handleChange",t);var e=t.target.files;e&&(this.uploadFiles(e),this.$refs.input.value=null)},uploadFiles:function(t){var e=this,n=Array.prototype.slice.call(t);this.multiple||(n=n.slice(0,1)),0!==n.length&&n.forEach(function(t){e.upload(t)})},upload:function(t){var e=this;if(!this.beforeUpload)return this.post(t);var n=this.beforeUpload(t);n&&n.then?n.then(function(n){"[object File]"===Object.prototype.toString.call(n)?e.post(n):e.post(t)},function(){}):!1!==n&&this.post(t)},post:function(t){var e=this;if(console.log("pose",t,this.format),console.log("flie size",t.size,t.name,t.type),this.maxSize&&t.size>1024*this.maxSize)return this.onExceededSize(t,this.fileList),!1;this.handleStart(t),h({headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:function(n){e.onProgress(n,t)},onSuccess:function(n){e.onSuccess(n,t)},onError:function(n,o){e.onError(n,o,t)}})},handleStart:function(t){t.uid=d()()+this.tempIndex++;var e={status:"uploading",name:t.name,size:t.size,percentage:0,uid:t.uid,showProgress:!0};this.fileList.push(e)}}},g=n("17cc"),m=Object(g.a)(f,function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{ref:"input",staticClass:"upload-button",attrs:{type:"file",multiple:t.multiple,accept:t.accept},on:{change:t.handleChange}})},[],!1,null,null,null).exports,v=n("c9f4"),w=n.n(v),y=n("a3f4"),b=n.n(y),C=n("a078"),q=n.n(C),_=n("eb9e"),k=n.n(_);console.log("hljs",k.a),w.a.register("modules/imageResize",b.a);var T={data:function(){return{quill:null,html:"",show:!1,title:"",topic:{},author:{nickname:"",avatar:"",name:""},_html:"",formUrl:"http://up-z2.qiniu.com",qiniu_store:"http://poq55glum.bkt.clouddn.com/",uploadData:{},qiniu_token:"",fullscreenLoading:!1,uploadType:"image",getTokenCallBack:null,accept:"image/*",viewType:window.viewType||0,tableHeight:"500",screenHeight:window.innerHeight}},created:function(){var e=this;try{console.log("view TYpe",window,window.viewType,this.viewType),window.WV_viewType=function(t){console.log("WV_viewType",t),e.viewType=t},window.WV_getHtml=function(){console.log(e.html),e.sendToRN("SUBMIT",{title:e.title,html:e.html})},window.WV_qiniuToken=function(t){console.log("token",t),e.getTokenCallBack&&e.getTokenCallBack(t)},window.WV_renderHtml=function(t){console.log("WV_renderHtml ",t),e.html=t.content,e.topic=t,e.author=t.author},window.WV_undo=function(){console.log("vue 后撤",e.quill),e.quill&&e.quill.history.undo()},window.WV_redo=function(){console.log("vue 前撤"),e.quill&&e.quill.history.redo()},window.WV_qiniuUpload=function(t){console.log("上传",t),e.handleSuccess(t)}}catch(t){console.error("created error",t)}},mounted:function(){var t=this;try{if(!this.viewType){var e=this,n=c()(q.a.height_config.languages);n.length>0&&n.forEach(function(t,e){k.a.registerLanguage(t,q.a.height_config.languages[t])}),k.a.initHighlightingOnLoad(),this.quill=new w.a(this.$refs.editor,{placeholder:"",theme:"snow",modules:{syntax:{highlight:function(t){return k.a.highlightAuto(t).value}},toolbar:{container:"#toolbar",handlers:{image:function(t){t?(document.querySelector(".upload-button").click(),console.log("value",t)):e.quill.format("image",!1)}}},imageResize:{displayStyles:{backgroundColor:"black",border:"none",color:"white"}}}}),this.quill.on("scroll-optimize",function(e,n,o){var a=t.$refs.editor.children[0].innerHTML;t.html=a.replace('contenteditable="true"',"")})}var o=function(){console.log("document.title",document.title),t.sendToRN("HEIGHT",{show:!0,height:t.$refs.app.clientHeight})};o(),window.addEventListener("load",function(){o()}),window.addEventListener("resize",o)}catch(n){console.error("mounted",n)}},methods:{sendToRN:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{window.ReactNativeWebView.postMessage(r()({type:t,data:e}))}catch(t){console.error("send to rn error",t)}},beforeUpload:function(t){return console.log("befor upload",t),this.qiniuUpload(t)},getToken:function(t,e,n,o,a){var s=this;return new i.a(function(t,a){s.sendToRN("QN_TOKEN",{});var i=s;s.getTokenCallBack=function(a){i.uploadData={key:"image/".concat(e.join("."),"_").concat(n,".").concat(o),token:a},t(i.uploadData)}})},qiniuUpload:function(t){this.fullscreenLoading=!0;var e=t.name.split("."),n=e.splice(e.length-1,1)[0],o=(new Date).getTime();return this.getToken(t,e,o,n)},handleProgress:function(t,e){console.log("handleProgress",t)},handleError:function(t,e){console.log("error",t,e)},handleSuccess:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.fullscreenLoading=!1;var o="";if("image"===this.uploadType?(console.log("handleSuccess",t),console.log("handleSuccess",e),console.log("handleSuccess",n),o=this.qiniu_store+t.key):"video"===this.uploadType&&(o=STATVIDEO+t.key),o){var a=this.quill.getSelection().index;this.quill.insertEmbed(a,this.uploadType,o,w.a.sources.USER),this.quill.setSelection(a+1)}else console.error("图片插入失败")}},components:{Upload:m}},S=(n("e674"),Object(g.a)(T,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"app",staticClass:"home",attrs:{id:"app"}},[0===t.viewType?n("div",{staticClass:"editor-box"},[t._m(0),n("div",{staticClass:"topic-title-box"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"topic-title",attrs:{type:"text",placeholder:"请输入标题"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),n("div",{staticClass:"div-1px"}),n("div",{ref:"editor",staticClass:"quill-box"}),n("Upload",{ref:"upload",staticClass:"file-button",attrs:{multiple:"",accept:t.accept,"before-upload":t.beforeUpload,"on-success":t.handleSuccess,"on-error":t.handleError,"on-progress":t.handleProgress,"max-size":2048,format:["jpg","jpeg","png","gif"],action:t.formUrl,data:t.uploadData}})],1):n("div",{staticClass:"quill-box quill-editor ql-container ql-snow"},[n("h1",{staticClass:"title"},[t._v(t._s(t.topic.title))]),n("div",{staticClass:"topic-info"},[n("div",{staticClass:"info-left"},[n("img",{staticClass:"avatar",attrs:{src:t.author.avatar,alt:t.author.nickname}}),n("span",{staticClass:"nickname"},[t._v(t._s(t.author.nickname))])]),t._m(1)]),n("div",{ref:"content",staticClass:"ql-editor",domProps:{innerHTML:t._s(t.html)}})])])},[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"toolbar"}},[n("select",{staticClass:"ql-header"},[n("option",{attrs:{value:"1"}},[t._v("标题1")]),n("option",{attrs:{value:"2"}},[t._v("标题2")]),n("option",{attrs:{value:"3"}},[t._v("标题3")]),n("option",{attrs:{selected:""}},[t._v("正文")])]),n("button",{staticClass:"ql-bold"}),n("button",{staticClass:"ql-italic"}),n("button",{staticClass:"ql-underline"}),n("button",{staticClass:"ql-code-block"}),n("select",{staticClass:"ql-align"}),n("select",{staticClass:"ql-color"}),n("select",{staticClass:"ql-background"}),n("button",{staticClass:"ql-image"}),n("button",{staticClass:"ql-link"}),n("button",{staticClass:"ql-video"}),n("button",{staticClass:"ql-script",attrs:{value:"sub"}}),n("button",{staticClass:"ql-script",attrs:{value:"super"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"info-right"},[e("div",{staticClass:"btn-success btn"},[this._v("关注")])])}],!1,null,"796a5d81",null).exports),x=n("7f3d"),E=n("d075"),D=n("edc2"),j=n("e965"),M=n("1887"),R=n("5f43"),F=n("7f43"),O=n.n(F),H=n("de8e"),L=function(){function t(){Object(E.a)(this,t)}return Object(D.a)(t,[{key:"get",value:function(){throw new Error("Abstract methods must be implemented")}},{key:"post",value:function(){throw new Error("Abstract methods must be implemented")}},{key:"getTopics",value:function(){return this.get("/topics")}}]),t}();O.a.defaults.withCredentials=!0;var U=function(t){function e(t,n){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(E.a)(this,e),(o=Object(j.a)(this,Object(M.a)(e).call(this))).med=!1;var s=q.a.axios_config,r=s.baseClientURL,l=s.timeout,c=s.withCredentials,u=O.a.create(Object(x.a)({baseURL:r,timeout:l,withCredentials:c,headers:{Accept:"application/json, text/javascript, */*","Content-Type":"application/json;charset=utf-8"}},a));return t&&(u.interceptors.request.use(function(t){return t},function(t){return H.a.error(t.message||"请求失败"),i.a.reject(t)}),u.interceptors.response.use(function(t){return o.med,t.data},function(t){if(t&&t.response.status)switch(t.response.status){case 401:t.message="未授权，请登录";break;default:t.message="请求失败"}return H.a.error(t.message||"请求失败"),i.a.reject(t)})),o.http=u,o}return Object(R.a)(e,t),Object(D.a)(e,[{key:"get",value:function(t){try{return console.log("api get "+t),this.http.get(t)}catch(t){}}},{key:"post",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("api post",t,e);var o=n.is_med,a=void 0!==o&&o,i=n.key,s=void 0===i?"":i;return this.med=a,this.key=s,this.http.post(t,r()(e))}}]),e}(L);n("27c8"),Array.prototype.remove=function(t){var e=this.indexOf(t);e>-1&&this.splice(e,1)},Date.prototype.addTime=function(t,e){var n=this;switch(t){case"s":return new Date(Date.parse(n)+1e3*e);case"n":return new Date(Date.parse(n)+6e4*e);case"h":return new Date(Date.parse(n)+36e5*e);case"d":return new Date(Date.parse(n)+864e5*e);case"w":return new Date(Date.parse(n)+6048e5*e);case"q":return new Date(n.getFullYear(),n.getMonth()+3*e,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());case"m":return new Date(n.getFullYear(),n.getMonth()+e,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());case"y":return new Date(n.getFullYear()+e,n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())}},Date.prototype.day_mow=function(){var t="";return t+"周"+["日","一","二","三","四","五","六"][this.getDay()]},Date.prototype.Format=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yyyy/MM/dd hh:mm:ss",e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},o.a.config.productionTip=!1,o.a.prototype.$http=new U(!1,!0),new o.a({render:function(t){return t(S)}}).$mount("#app")},"59d6":function(t,e,n){},a078:function(t,e,n){var o={axios_config:{baseClientURL:"/api",timeout:"5000",withCredentials:!0},webpack_config:{bundleView:!0,imgMin:!0,alias:{components:"../components"},globalParams:{VERSION:"1.0.0"}},height_config:{languages:{javascript:n("e372"),dockerfile:n("e68c"),java:n("993a"),sql:n("10c4"),htmlbars:n("67ea"),"vbscript-html":n("3cfb"),xml:n("5c93"),python:n("77fd"),scss:n("e4aa"),less:n("510d"),css:n("60c2"),stylus:n("2117"),php:n("0346"),nginx:n("1486"),http:n("4e3a"),go:n("5bee"),dart:n("181c"),json:n("efe2"),kotlin:n("60d1")}}};t.exports=o},e674:function(t,e,n){"use strict";var o=n("59d6");n.n(o).a},fd41:function(t,e,n){}},[[0,"runtimechunk~app","vendor"]]]);